## Swift 문법 2



### 구조체와 클래스

**중첩 타입의 정의 및 선언이 가능하다(클래스 안에 클래스, 구조체안에 구조체)**

**Reference Count는 클래스의 인스턴스에만 적용된다.**

#### 구조체

1. 값 타입(**스위프트의 데이터 타입과 enum은 모두 값타입**) - 값이 복사되어 사용된다.
2. 스위프트의 모든 데이터 타입은 구조체다 -> **타입캐스팅이 아닌 init()으로 형변환 하고 있는 것**
3. 구조체에서 인스턴스를 생성하고 초기화하고자 할 때는 기본적으로 생성되는 멤버와이즈 이니셜라이즈를 사용한다

   1. 멤버와이즈 이니셜라이즈

      - 구조체는 사용자정의 이니셜라이즈를 구현하지 않으면 프로퍼티의 이름으로 매개변수를 갖는 이니셜라이저인 멤버와이즈 이니셜라이즈를 기본으로 제공한다.
      - 멤버와이즈 이니셜라이즈는 구조체만의 특권! (클래스에서는 멤버와이즈 이니셜라이즈를 지원하지 않는다.)

3. 구조체의 인스턴스를 let으로 선언하면 인스턴스 내부의 프로퍼티 값을 변경해 줄 수 없다.

```swift
 struct BasicStruct {
  	var name: String
      var age: Int
  }
  
  var myInfo = BasicStruct(name: "Junyoung", age: 26)
  let yourInfo = BasicStruct(name: "Doby", age" 7")
  yourInfo.name = "Harry" // 변경 불가
  
```

4. 구조체는 상속할 수 없다.
5. **멀티스레딩환경에서 안전하게 사용가능**
6. 참조카운트가 없어서 메모리 관리에 안전

#### 클래스

1. 참조 타입 - 주소가 전달된다.

2. 스위프트의 클래스는 다중상속이 불가능하다.

3. 구조체와 다르게 클래스의 인스턴스는 참조타입이므로 클래스의 인스턴스를 let으로 선언해도 내부 프로퍼키 값을 변경할 수 있다.

4. 디이니셜라이져: deinit()

   - 클래스 내부에 deinit 메서드를 구현해 주면 소멸되기 직전에 deinit메서드가 호출된다.

   - 클래스 하나당 하나만 구현할 수 있다.
   - 인스턴스가 메모리에서 해제되기 직전에 적절한 작업을 하도록 할 수 있다.

5. 클래스의 저장 프로퍼티는 옵셔널이 아니라면 프로퍼티의 기본값을 지정해해주거나 사용자정의 이니셜라이져를 통해 반드시 초기화해 주어야한다.



### 프로터피와 메서드

#### 프로퍼티

1. 저장 프로퍼티

   - let, var을 사용하여 값을 저장하는 프로퍼티

   - 프로퍼티 감시자 {didSet, willSet}
     - 지연 저장 프로퍼티에 사용할 수 없다.
     - 연산프로퍼티는 상속받았을 때만 프로퍼티 재정의를 통해 프로퍼티 감시자를 사용할 수 있다.
   - lazy: 지연 저장 프로퍼티 - 해당 프로퍼티로 처음 접근할때 초기화가 된다.

2. 연산 프로퍼티

   - setter
   - getter

3. 타입 프로퍼티

   - Static 키워드 사용
   - 인스턴스가 아닌 타입 자체에 속하는 프로퍼티를 타입프로퍼티라고 한다.
   - 인스턴스 생성 여부와 상관없이 타입 프로퍼티의 값은 하나이다.

#### 메서드

1. 인스턴스 메서드
   - 자신의 프로퍼티값을 수정할 때 구조체나 열거형 같은 값 타입인 경우 메서드 앞에 `mutating` 키워드를 붙여서 해당 메서드가 인스턴스 내부의 값을 변경한다는 것을 명시해야 한다.
2. 타입 메서드
   - static 키워드: 상속 후 메서드 재정의 불가
   - class 키워드: 상속 후 메서드 재정의 가능



### 인스턴스 생성 및 소멸

#### 인스턴스 생성

1. 프로퍼티 기본값

   - 저장프로퍼티가 초기화될 때는 프로퍼티 감시자 메서드를 호출하지  않는다.

2. 사용자정의 이니셜라이저를 만들면 기존의 기본 이니셜라이즈 init()는 별도로 구현하지 않는 이상 사용할 수 없다.

3. 기본 이니셜라이즈와 멤버와이즈 이니셜라이즈

   - 사용자정의 이니셜라이즈를 정의해주지 않으면 클래스나 구조체는 모든 프로퍼티에 기본값이 지정되어 있다는 전제하에 기본 이니셜라이즈를 사용한다.
   - 구조체는 멤버와이즈 이니셜라이즈를 제공해 준다.

4. 초기화 위임

   - 값타입(구조체, 열거형)에서는 이니셜라이즈가 다른 이니셜라이저에게 초기화를 위임할 수 있다.

5. 실패 가능한 이니셜라이저: init? 키워드 사용

6. **함수를 사용한 프로퍼티값 설정**

   - 프로퍼티 기본값을 설정해주기 위해 클로저를 사용한다면 클로저가 실행되는 시점은 인스턴스의 다른 프로퍼티 값이 설정되기 전이다. -> 따라서 클로저 내부에서는 인스턴스의 다른 프로퍼티를 사용하여 연산할 수 없다. self도 사용할 수 없음.

     ```swift
     class SomeClass {
         let someProperty: SomeType = {
             //새로운 인스턴스를 생성하고 사용자 정의 연산을 통한 후 반환해 준다.
             var someValue: SomeType
             // 반환되는 값의 타입은 SomeType과 같은 타입이여야 한다.
         }()
     }
     ```



      



#### 접근제어

1. open
   - 모듈 외부까지 사용가능 (클래스에서만 사용)
2. public
   - 모듈 외부까지 사용가능
3. internal
   - 모듈 내부 (default)
4. fileprivate
   - 파일 내부
5. private
   - 기능 정의 내부